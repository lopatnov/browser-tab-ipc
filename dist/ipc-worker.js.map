{"version":3,"file":"ipc-worker.js","sources":["../src/ipc-worker.ts"],"sourcesContent":["(function (self: SharedWorkerGlobalScope) {\n  const ports = new Set<MessagePort>();\n  self.onconnect = (e) => {\n    if (e?.source && e.source instanceof MessagePort) {\n      const port = e.source;\n      ports.add(port);\n      port.onmessage = (ev: MessageEvent) => {\n        const data = ev.data;\n        const cmd = data?.cmd;\n        switch (cmd) {\n          case 'x':\n            ports.delete(port);\n            break;\n          default:\n            ports.forEach((p) => {\n              if (p !== port) {\n                p.postMessage(data);\n              }\n            });\n        }\n      };\n      port.start();\n    }\n  };\n\n  self.onerror = (e) => {\n    console.error(e);\n  };\n})(self as any);\n\nexport {};\n"],"names":[],"mappings":";;;EAAA,CAAC,UAAU,IAA6B,EAAA;EACtC,IAAA,MAAM,KAAK,GAAG,IAAI,GAAG,EAAe;EACpC,IAAA,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,KAAI;EACrB,QAAA,IAAI,CAAA,CAAC,KAAA,IAAA,IAAD,CAAC,uBAAD,CAAC,CAAE,MAAM,KAAI,CAAC,CAAC,MAAM,YAAY,WAAW,EAAE;EAChD,YAAA,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM;EACrB,YAAA,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC;EACf,YAAA,IAAI,CAAC,SAAS,GAAG,CAAC,EAAgB,KAAI;EACpC,gBAAA,MAAM,IAAI,GAAG,EAAE,CAAC,IAAI;kBACpB,MAAM,GAAG,GAAG,IAAI,KAAA,IAAA,IAAJ,IAAI,KAAA,MAAA,GAAA,MAAA,GAAJ,IAAI,CAAE,GAAG;kBACrB,QAAQ,GAAG;EACT,oBAAA,KAAK,GAAG;EACN,wBAAA,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC;0BAClB;EACF,oBAAA;EACE,wBAAA,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,KAAI;EAClB,4BAAA,IAAI,CAAC,KAAK,IAAI,EAAE;EACd,gCAAA,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC;8BACrB;EACF,wBAAA,CAAC,CAAC;;EAER,YAAA,CAAC;cACD,IAAI,CAAC,KAAK,EAAE;UACd;EACF,IAAA,CAAC;EAED,IAAA,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,KAAI;EACnB,QAAA,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;EAClB,IAAA,CAAC;EACH,CAAC,EAAE,IAAW,CAAC;;;;;;"}