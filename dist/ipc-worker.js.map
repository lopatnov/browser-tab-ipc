{"version":3,"file":"ipc-worker.js","sources":["../src/ipc-worker.ts"],"sourcesContent":["(function (self: SharedWorkerGlobalScope) {\n  const ports = new Set<MessagePort>();\n  self.onconnect = (e) => {\n    if (e?.source && e.source instanceof MessagePort) {\n      const port = e.source;\n      ports.add(port);\n      port.addEventListener(\n        'message',\n        (ev: any) => {\n          const data = ev.data;\n          const cmd = data?.cmd;\n          switch (cmd) {\n            case 'x':\n              ports.delete(port);\n              break;\n            default:\n              ports.forEach((p) => {\n                if (p !== port) {\n                  p.postMessage(data);\n                }\n              });\n          }\n        },\n        false,\n      );\n      port.start();\n    }\n  };\n\n  self.onerror = (e) => {\n    console.error(e);\n  };\n})(self as any);\n\nexport {};\n"],"names":[],"mappings":";;AAAA,CAAC,UAAU,IAA6B;IACtC,IAAM,KAAK,GAAG,IAAI,GAAG,EAAe,CAAC;IACrC,IAAI,CAAC,SAAS,GAAG,UAAC,CAAC;QACjB,IAAI,CAAA,CAAC,aAAD,CAAC,uBAAD,CAAC,CAAE,MAAM,KAAI,CAAC,CAAC,MAAM,YAAY,WAAW,EAAE;YAChD,IAAM,MAAI,GAAG,CAAC,CAAC,MAAM,CAAC;YACtB,KAAK,CAAC,GAAG,CAAC,MAAI,CAAC,CAAC;YAChB,MAAI,CAAC,gBAAgB,CACnB,SAAS,EACT,UAAC,EAAO;gBACN,IAAM,IAAI,GAAG,EAAE,CAAC,IAAI,CAAC;gBACrB,IAAM,GAAG,GAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,GAAG,CAAC;gBACtB,QAAQ,GAAG;oBACT,KAAK,GAAG;wBACN,KAAK,CAAC,MAAM,CAAC,MAAI,CAAC,CAAC;wBACnB,MAAM;oBACR;wBACE,KAAK,CAAC,OAAO,CAAC,UAAC,CAAC;4BACd,IAAI,CAAC,KAAK,MAAI,EAAE;gCACd,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;6BACrB;yBACF,CAAC,CAAC;iBACN;aACF,EACD,KAAK,CACN,CAAC;YACF,MAAI,CAAC,KAAK,EAAE,CAAC;SACd;KACF,CAAC;IAEF,IAAI,CAAC,OAAO,GAAG,UAAC,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KAClB,CAAC;AACJ,CAAC,EAAE,IAAW,CAAC;;"}